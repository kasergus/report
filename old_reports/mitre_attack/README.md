# Жизненный цикл атаки

Описание жизненного цикла атак на инфраструктуру коммерческой организации, которая занимается грузоперевозкой согласно матрице атак MITRE. 

## 1. Разведка

Производим попытку выяснить логин целевых акканутов (таких как бухгалтерии, менеджеров или службы IT) через нахождения/исследования или компрометации (по возможности) данных, которые находятся в кадровой службы. Это предпочтительный способ, однако если не вышло, можно попытаться через пинг хостов в локальной сети компании или социальной инженерии.

## 2. Подготовка ресурсов

На основе данных подготавливаем эксплойты: на случай незнания паролей и отсутсвии связей или знакомств с аккаунтами менеджер менеджерами готовим брутфорс эксплойты/подгружаем вирусы удалённого доступа с помощью фреймворков (например metasploit) на хосты, которые можно узнать руководствуясь первым пунктом.

## 3. Первоначальный доступ

Скомпрометировав хотя бы одному АРМ, выполняем следующие действия:

* **АРМ менеджера**: компрометируем маршруты всех грузоперевозочных механизмов, номера машин и прочую персональную информацию

* **АРМ бухгалтера**: находим данные сотрудников, пытаемся скомпрометировать номера электронных карт путём выяснения хеша шифрования базы данных (так как скорей всего данные находятся в зашифрованном виде)

* **АРМ IT специалиста**: ищем данные о сайте, например пароли, ключи или различные мисконфигурации

## 4. Закрепление

Прописываем себя в автозапуск, используем полезные нагрузки, выполняем процесс постэксплуатации (например при активном ответ команды реагирования запускаем шифровальщик, который блокирует данные в системе)

## 5. Повышение привилегий

* **АРМ менеджера**: не требуется, поскольку менеджер в данной организации - самая высшая учётная запись в контексте прав

* **АРМ бухгалтера**: высылаем от лица бухгалтера (его данные известны из пункта "Первоначальный доступ") менеджеру различные фишинговые письма

* **АРМ IT специалиста**: если это АРМ непосредственного разработчика базы данных и бэкенда, в этом нет необходимости, в противном случае пытаемся получить доступ к базе данных или серверу

## 6. Закрепление

Усиливаем свою позицию в системе, используя вспомогательные средства для успешного выполнения вредосного кода и действий. Например:

* NOPs - инструкции фреймворка metasploit для защиты выполнения полезной нагрузки

* Post - код, который помогает глубже проникнуть в систему (из-за этого будет сложнее убрать все вредоносные последствия)

## 7. Предовращение обнаружений

"Зачищаем следы", используя руткит и прочие утилиты (например moonwalk).

## 8. Получение учётных данных

Пытаемся скомпрометировать все доступные нам УЗ, высылая на них фишинговые письма, используя брутфорс атаки или же просто изолируя их от системы для саботирования работы компании.

## 9. Исследование

Выполняем сканирование сети на взломанном АРМ на другие АРМ и УЗ.

## 10. Перемещение внутри пермитера

Среди известных записей ищем целевые, которые описаны в этапе "Разведка". Приоритетная цель - УЗ менеджера.

## 11. Сбор данных

Собираем всю возможную информацию о:

* Сотрудниках, если не нашли УЗ менеджера (что бы скомпрометировать её)

* Маршрутах и номерах, если нашли УЗ менеджера и не сделали этого ранее

## 12. Управление и контроль

Создаём защищённый VPN канал, копируем все нужные нам данные, изолируем и отключаем антивирусы

## 13. Эксфильтрация данных

Передаём данные в безопасное для нас место, снимаем деньги со скомпрометированных счетов сотрудников

## 14. Воздействие

Делаем то, что изначально хотели, например:

* Отдаём приказы за менеджера о прекращении работы отдела компании, тем самым нанося мощный удар по инфраструктуре и саботируя работу

* Вычисляем нужных нам людей в поисках компромата на них

* Практически что угодно, так как у нас есть доступ ко всему отделу компании

* Расширяем зону заражения на остальные отделы в других городах или странах